# 插件机制

babel 插件分为转换插件（转换阶段）

TODO: babel 插件机制的设计

1. 统一的插件接口设计，
1. 插件尽可能设计成纯函数式的，无副作用
1. 是否需要全局环境 context 数据
1. 插件的顺序问题？ https://jamie.build/babel-plugin-ordering.html
1. 插件的状态问题，一个插件多次运行，每次能够记录数据，根据数据每次运行的结果不同？
1. 各种设计考虑问题有哪些具体的例子？
1. 插件支持同步和异步的模式

插件包括语法插件和转换插件，如果使用了转换插件，自动激活相应的语法插件，不需要再手动引入。

`transformFile`函数中插件的执行过程

1. 遍历插件集合，执行插件的 pre 方法。
1. 遍历插件集合，合并插件的 visitor 方法，输出是一个包含了所有插件逻辑的 visitor 方法。
1. 执行第二步合成的 visitor 方法。
1. 遍历插件集合，执行插件的 post 方法。
